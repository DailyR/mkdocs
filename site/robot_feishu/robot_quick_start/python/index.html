<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Quickly develop a bot - Dailysword</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Quickly develop a bot";
        var mkdocs_page_input_path = "robot_feishu\\robot_quick_start\\python\\README.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Dailysword
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">DailysCodeDocs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../history_sample/">History sample</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">ChangeTime</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ChangeTime/">DailyCode</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">EasyTest</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../EasyTest/">EasyTest</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Alpha</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="#">Alpha test 1</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../EasyTest/Alpha/Alpha_test_1/history/">History</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Alpha test 4</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../EasyTest/Alpha/Alpha_test_4/history/">History</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Alpha test 7</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../EasyTest/Alpha/Alpha_test_7/history/">History</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Beta</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="#">Beta test 1</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../EasyTest/Beta/Beta_test_1/history/">History</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Beta test 2</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../EasyTest/Beta/Beta_test_2/history/">History</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Go</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Go/">DailysCodeDocs for Go & kubernetes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Go/history/">History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced lessons</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../advanced-lessons/">进阶python</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">FileConfig Get</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../advanced-lessons/FileConfig_Get/history_sample/">History sample</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Base the hard way</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../base_the_hard_way/">基础python</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Chrome selenium webdriver</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../chrome_selenium_webdriver/">selenium  web自动化</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">easy test Guide Chapter1</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../chrome_selenium_webdriver/easy_test_Guide_Chapter1/">selenium  web自动化</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">erlang Code</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../erlang_Code/">Erlang_Code</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gamemirror</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../gamemirror/">DailysGamemirrorDocs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Kubernetes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../kubernetes/">DailysCodeDocs for Go & kubernetes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../kubernetes/history/">History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Minikube</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../kubernetes/minikube/minikube/">Minikube</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Lua luamon</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../lua_luamon/">关于LuaMon   （名称：luamon调试和自动化测试，类似于内挂）</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Robot feishu</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Robot quick start</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Python</a>
    <ul class="current">
                <li class="toctree-l3 current"><a class="reference internal current" href="./">Quickly develop a bot</a>
    <ul class="current">
    <li class="toctree-l4"><a class="reference internal" href="#runtime-environment">Runtime environment</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#prep-work">Prep work</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#running-with-docker">Running with Docker</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#running-locally">Running Locally</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#complete-the-configuration-and-experience-the-bot">Complete the configuration and experience the bot</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="README.zh/">快速开发机器人</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Stress robot</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../stress_robot/">Robot压测机器人</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Svnhook</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../svnhook/">svnhook</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Websocket</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../websocket/">Index</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Dailysword</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Robot feishu &raquo;</li>
          <li>Robot quick start &raquo;</li>
          <li>Python &raquo;</li><li>Quickly develop a bot</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="quickly-develop-a-bot">Quickly develop a bot</h1>
<blockquote>
<p>⚠️ In order to facilitate the implementation of this tutorial, a reverse proxy tool (ngrok) is used. This tool is only suitable for the development and testing phase and cannot be used in the production environment. Before using it, you need to confirm whether it complies with the company's network security policy.</p>
</blockquote>
<p>This example shows how to use the Open Platform's bot function to have a bot receive user messages and make replies. You
can extend the event processing functions of bot based on this example.</p>
<h2 id="runtime-environment">Runtime environment</h2>
<ul>
<li><a href="https://www.python.org/">Python 3</a></li>
<li><a href="https://ngrok.com/download">ngrok</a> (intranet penetration tool)</li>
</ul>
<h2 id="prep-work">Prep work</h2>
<ol>
<li>In <a href="https://open.feishu.cn/app/">Developer Console</a>, click <strong>Create custom app</strong>, then click the app name to go to
   the app details page.</li>
<li>Go to <strong>Credentials &amp; Basic Info</strong> to obtain the <code>App ID</code> and <code>App Secret</code>, and then go to <strong>Event Subscriptions</strong> to
   obtain the
   <code>Encrypt Key</code> and <code>Verification Token</code>.</li>
<li>
<p>Pull the latest code to local and enter the corresponding directory.
    <code>git clone https://github.com/larksuite/lark-samples.git
    cd lark-samples/robot_quick_start/python</code></p>
</li>
<li>
<p>Edit environment variables</p>
</li>
</ol>
<p>Edit the app credential data in the <code>.env</code> file to real data.
    <code>APP_ID=cli_9fxxxx00b
    APP_SECRET=EX6xxxxOF
    APP_VERIFICATION_TOKEN=cq3xxxxxxkUS 
    ENCRYPT_KEY=</code>
   The above parameters can be viewed in <a href="https://open.feishu.cn/app/">Developer Console</a>. Encrypt Key can be empty.</p>
<h2 id="running-with-docker">Running with Docker</h2>
<p>Ensure that <a href="https://www.docker.com/">Docker</a> has been installed before running. You can choose to run your code either
with Docker or locally.</p>
<p><strong>Mac/Linux</strong></p>
<pre><code>sh exec.sh
</code></pre>
<p><strong>Windows</strong></p>
<pre><code>.\exec.ps1
</code></pre>
<h2 id="running-locally">Running Locally</h2>
<ol>
<li>Create and activate a new virtual environment.</li>
</ol>
<p><strong>Mac/Linux</strong>
   <code>python3 -m venv venv 
   . venv/bin/activate</code></p>
<p><strong>Windows</strong>
   <code>python3 -m venv venv 
   venv\Scripts\activate</code></p>
<p>Once activated, the terminal will display the virtual environment's name.
   <code>(venv) **** python %</code></p>
<ol>
<li>Install dependencies</li>
</ol>
<p><code>pip install -r requirements.txt</code></p>
<ol>
<li>Run</li>
</ol>
<p><code>python3 server.py</code></p>
<h2 id="complete-the-configuration-and-experience-the-bot">Complete the configuration and experience the bot</h2>
<p>The messages received by the bot are all in the format of callback event request. Using the POST request method, they
are sent to the server for processing. Once the local server is started, the callback event can't make requests to the
intranet. The public network request URL must be configured.</p>
<p>Configuration involves the following two steps: Use the tool to penetrate the intranet, and go to the <strong>Event
Subscriptions</strong> page to configure the public network request URL.</p>
<ol>
<li>
<p>Use the tool to expose the public network access portal for the local server. ngrok is used as an example here. If
   the local has not been installed, you can access <a href="https://ngrok.com/download">ngrok</a>, and complete the installation
   according to the guide.</p>
</li>
<li>
<p>Use the following commands to obtain the public network URL</p>
</li>
</ol>
<p><strong>Note</strong>: Before using a reverse proxy tool (ngrok), you need to determine whether it complies with the company's
  network security policy.</p>
<p><strong>Note</strong>: Need to get the token value in <a href="https://dashboard.ngrok.com/signup">ngrok</a> in advance.
   <code>ngrok authtoken &lt;token&gt; // &lt;token&gt; needs to be replaced
   ngrok http 3000</code></p>
<ol>
<li>Go to <strong>Features</strong> &gt; <strong>Bot</strong> to enable <strong>Using Bot</strong>.</li>
<li>
<p>Go to the <strong>Event Subscriptions</strong> page to configure the <strong>Request URL</strong>. Use the tool to generate the domain and fill
   in the request URL, as shown in the figure below.
   <img alt="image.png" src="https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/0ce38ea653e636accbd6d268b69360f9_Osy22NvNOK.png" />
   <strong>Note</strong>: Configuring the request URL and sending messages to the bot will both send requests to the backend server.
   During the request period, the server should be kept in enabled status.</p>
</li>
<li>
<p>Select the events listened to by the bot.</p>
</li>
</ol>
<p>On the <strong>Event Subscriptions</strong> page, click <strong>Add event</strong> and select and subscribe to the <code>Message received</code> event.
5. Add scopes to the bot</p>
<p>On the <strong>Permissions &amp; Scopes</strong> page, search for the scopes you need, and add them to the bot.</p>
<ul>
<li>Dependent scope list<ul>
<li>Read and send messages in private and group chats</li>
<li>Read private messages sent to the bot</li>
</ul>
</li>
</ul>
<p><strong>Note</strong>: The <code>Read private messages sent to the bot</code> scope is not displayed in <strong>Added events</strong>. You must switch to
  the <strong>Permissions &amp; Scopes</strong> page to add it to your bot.</p>
<ol>
<li>On the <strong>Version Management &amp; Release</strong> page, click <strong>Create a version</strong> &gt; <strong>Submit for release</strong>.</li>
</ol>
<p><strong>Note</strong>: The release involves scopes that need to be manually approved. You can use Test companies and users
   function to generate a test version and complete the test. Note: After release, you can check whether users are
   within the bot's availability range based on whether they can find the bot.</p>
<ol>
<li>Open <strong>Feishu</strong> and search for the <strong>Bot name</strong> to begin experiencing the bot's auto replies.</li>
</ol>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../../lua_luamon/" class="btn btn-neutral float-left" title="关于LuaMon   （名称：luamon调试和自动化测试，类似于内挂）"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="README.zh/" class="btn btn-neutral float-right" title="快速开发机器人">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../../lua_luamon/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="README.zh/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
